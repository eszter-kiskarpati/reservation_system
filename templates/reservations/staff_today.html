{% extends "admin/base_site.html" %}
{% load static %}

{% block extrastyle %}
  {{ block.super }}
  {# change the path to match your actual CSS filename #}
  <link rel="stylesheet" href="{% static 'css/staff_today.css' %}">
{% endblock %}

{% block title %}Today's reservations{% endblock %}

{% block content %}
  <h1>Today's reservations â€” {{ today }}</h1>

  {% if reservations %}
    <table class="table table-striped" style="margin-top: 1rem;">
        <thead>
            <tr>
                <th>Time</th>
                <th>Name</th>
                <th>Party</th>
                <th>Seating</th>
                <th>Table</th>
                <th>Status</th>
                <th>Notes</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            {% for r in reservations %}
                <tr class="res-row
                    {% if r.status == 'PENDING' %}res-pending
                    {% elif r.status == 'CONFIRMED' %}res-confirmed
                    {% elif r.status == 'SEATED' %}res-seated
                    {% elif r.status == 'COMPLETED' %}res-completed
                    {% elif r.status == 'NO_SHOW' %}res-no-show
                    {% elif r.status == 'CANCELLED' %}res-cancelled
                    {% endif %}">
                    <td>{{ r.time }}</td>
                    <td>{{ r.name }}</td>
                    <td>{{ r.party_size }}</td>

                    <td>
                        {% if r.assigned_area %}
                            {{ r.get_assigned_area_display }}
                        {% else %}
                            {{ r.get_seating_preference_display }}
                        {% endif %}
                    </td>

                    <td>
                        {% if r.tables.count %}
                            {% for t in r.tables.all %}
                                {{ t }}{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                        {% else %}
                            -
                        {% endif %}
                    </td>

                    <td>{{ r.get_status_display }}</td>

                    <td>{{ r.notes|default:"-" }}</td>

                    <td>
                        <form method="post"
                            action="{% url 'staff_update_status' r.pk %}"
                            style="display:inline;">
                            {% csrf_token %}
                            <input type="hidden" name="status" value="SEATED">
                            <button type="submit" class="button small-button">Seated</button>
                        </form>

                        <form method="post"
                            action="{% url 'staff_update_status' r.pk %}"
                            style="display:inline;">
                            {% csrf_token %}
                            <input type="hidden" name="status" value="NO_SHOW">
                            <button type="submit" class="button small-button">No show</button>
                        </form>

                        <form method="post"
                            action="{% url 'staff_update_status' r.pk %}"
                            style="display:inline;">
                            {% csrf_token %}
                            <input type="hidden" name="status" value="CANCELLED">
                            <button type="submit" class="button small-button">Cancelled</button>
                        </form>

                        <form method="post"
                            action="{% url 'staff_update_status' r.pk %}"
                            style="display:inline;">
                            {% csrf_token %}
                            <input type="hidden" name="status" value="COMPLETED">
                            <button type="submit" class="button small-button">Done</button>
                        </form>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
  {% else %}
    <p>No reservations for today.</p>
  {% endif %}
{% endblock %}
